<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, height=device-height">
    <title>DBH CASH - স্মার্ট আর্থিক ব্যবস্থাপনা</title>
    <meta name="description" content="DBH CASH - আপনার সম্পূর্ণ আর্থিক ব্যবস্থাপনার সমাধান। আয়-ব্যয় ট্র্যাকিং, স্মার্ট বাজেট পরিকল্পনা এবং আর্থিক লক্ষ্য অর্জনে সহায়তা করে।">
    <meta name="keywords" content="budget, expense tracker, bengali, finance, react, pwa, money manager, savings, DBH CASH">
    <meta name="theme-color" content="#10B981">
    
    <!-- PWA / Apple Touch Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="DBH CASH">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="DBH CASH">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="logo.svg">
    <link rel="icon" type="image/svg+xml" href="logo.svg">
    <link rel="shortcut icon" href="logo.svg" type="image/svg+xml">

    <!-- React -->
    <script src="https://resource.trickle.so/vendor_lib/unpkg/react@18/umd/react.production.min.js"></script>
    <script src="https://resource.trickle.so/vendor_lib/unpkg/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://resource.trickle.so/vendor_lib/unpkg/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <link href="https://resource.trickle.so/vendor_lib/unpkg/lucide-static@0.516.0/font/lucide.css" rel="stylesheet">

    <!-- Google Fonts for Bengali -->
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.9/dist/chart.umd.min.js"></script>

    <script>
        // Save Chart constructor to prevent conflicts
        const ChartJS = window.Chart;
        
        // ==================== OFFLINE/ONLINE STATUS ====================
        let isOnline = navigator.onLine;
        
        // Check online status
        window.addEventListener('online', () => {
            isOnline = true;
            console.log('✅ মোবাইল অনলাইন হয়েছে');
            window.dispatchEvent(new CustomEvent('app-online', { detail: { timestamp: Date.now() } }));
            showOnlineNotification();
        });
        
        window.addEventListener('offline', () => {
            isOnline = false;
            console.log('❌ মোবাইল অফলাইন হয়েছে');
            window.dispatchEvent(new CustomEvent('app-offline', { detail: { timestamp: Date.now() } }));
            showOfflineNotification();
        });
        
        // Show online notification
        function showOnlineNotification() {
            if (document.querySelector('.offline-banner')) {
                document.querySelector('.offline-banner').remove();
            }
            const banner = document.createElement('div');
            banner.className = 'online-banner fixed top-0 left-0 right-0 bg-green-500 text-white text-center py-2 z-50 animate-slide-down';
            banner.textContent = '✅ সংযোগ পুনরুদ্ধার হয়েছে';
            document.body.appendChild(banner);
            setTimeout(() => banner.remove(), 3000);
        }
        
        function showOfflineNotification() {
            if (document.querySelector('.online-banner')) {
                document.querySelector('.online-banner').remove();
            }
            const banner = document.createElement('div');
            banner.className = 'offline-banner fixed top-0 left-0 right-0 bg-red-500 text-white text-center py-2 z-50';
            banner.innerHTML = '❌ অফলাইন - ডেটা লোকালি সংরক্ষিত হচ্ছে';
            document.body.appendChild(banner);
        }

        // Register Service Worker with Advanced Features
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw-advanced.js')
                    .then(registration => {
                        console.log('✅ উন্নত SW নিবন্ধিত:', registration);
                        
                        // Check for updates periodically
                        setInterval(() => {
                            registration.update().catch(err => console.log('Update check failed:', err));
                        }, 60000); // Check every minute
                        
                        // Listen for controller change
                        registration.onupdatefound = () => {
                            const installingWorker = registration.installing;
                            installingWorker.onstatechange = () => {
                                if (installingWorker.state === 'installed') {
                                    if (navigator.serviceWorker.controller) {
                                        console.log('✅ নতুন আপডেট এসেছে');
                                        if(window.confirm('✨ নতুন সংস্করণ উপলব্ধ! রিফ্রেশ করতে চান?')) {
                                            installingWorker.postMessage({ type: 'SKIP_WAITING' });
                                            window.location.reload();
                                        }
                                    }
                                }
                            };
                        };
                    })
                    .catch(err => {
                        console.error('❌ SW নিবন্ধন ব্যর্থ:', err);
                    });
                
                // Listen for messages from SW
                navigator.serviceWorker.addEventListener('message', event => {
                    const { type, data } = event.data;
                    
                    if (type === 'SYNC_OFFLINE') {
                        console.log('⏳ অফলাইন - পরে সিঙ্ক হবে:', data);
                        window.dispatchEvent(new CustomEvent('sync-offline', { detail: data }));
                    }
                    
                    if (type === 'SYNC_SUCCESS') {
                        console.log('✅ সিঙ্ক সফল:', data);
                        window.dispatchEvent(new CustomEvent('sync-success', { detail: data }));
                    }
                    
                    if (type === 'SYNC_COMPLETE') {
                        console.log('✅ সিঙ্ক সম্পন্ন:', data);
                        window.dispatchEvent(new CustomEvent('sync-complete', { detail: data }));
                    }
                });
            });
        }
        
        // Auto-sync when online
        window.addEventListener('app-online', () => {
            if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {
                navigator.serviceWorker.controller.postMessage({
                    type: 'SYNC_DATA',
                    payload: {
                        timestamp: Date.now(),
                        event: 'online-reconnect'
                    }
                });
            }
        });
    </script>

    <style type="text/tailwindcss">
    @layer theme {
        :root {
            --primary-color: #10B981; /* Emerald 500 */
            --primary-hover: #059669; /* Emerald 600 */
            --bg-color: #F8F9FA;
            --sidebar-width: 260px;
            --ios-border-radius: 20px;
            --ios-font-size-large: 34px;
            --ios-font-size-title: 28px;
            --ios-font-size-headline: 17px;
            --ios-font-size-body: 16px;
            --ios-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
            --ios-shadow-elevated: 0 10px 25px rgba(0, 0, 0, 0.15), 0 6px 12px rgba(0, 0, 0, 0.1);
        }
    }

    @layer base {
        html, body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            position: fixed;
            overflow: hidden;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hind Siliguri', sans-serif;
            background-color: var(--bg-color);
            color: #1F2937;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: none;
            padding-top: env(safe-area-inset-top);
            padding-left: env(safe-area-inset-left);
            padding-right: env(safe-area-inset-right);
            padding-bottom: env(safe-area-inset-bottom);
            -webkit-font-smoothing: antialiased;
            -webkit-user-select: none;
            user-select: none;
            text-rendering: optimizeLegibility;
        }
        
        #root {
            width: 100%;
            height: 100%;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        /* Safe Area for iPhone X+ */
        .pb-safe-area {
            padding-bottom: env(safe-area-inset-bottom);
        }
        .pt-safe-area {
            padding-top: env(safe-area-inset-top);
        }
        .pl-safe-area {
            padding-left: env(safe-area-inset-left);
        }
        .pr-safe-area {
            padding-right: env(safe-area-inset-right);
        }
        
        /* iOS Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        h1 {
            font-size: var(--ios-font-size-large);
            line-height: 1.2;
        }
        
        h2 {
            font-size: var(--ios-font-size-title);
            line-height: 1.22;
        }
        
        h3 {
            font-size: var(--ios-font-size-headline);
            line-height: 1.29;
        }
        
        p, span, a {
            font-size: var(--ios-font-size-body);
            line-height: 1.6;
        }
        
        /* iOS Glass Morphism Effect */
        .glass {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        /* Mobile responsive fixes */
        @media (max-width: 768px) {
            body {
                font-size: 16px;
            }
            
            .sidebar {
                position: fixed;
                left: 0;
                top: calc(env(safe-area-inset-top) + 60px);
                width: 100%;
                max-width: 85vw;
                height: calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 60px - 60px);
                z-index: 30;
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
                width: 100%;
                padding-left: 0;
            }
            
            .header-wrapper {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                width: 100%;
                padding-top: env(safe-area-inset-top);
                padding-left: env(safe-area-inset-left);
                padding-right: env(safe-area-inset-right);
                z-index: 40;
                height: 60px;
                overflow: hidden;
            }
            
            .content-area {
                padding-top: calc(60px + env(safe-area-inset-top));
                padding-bottom: calc(60px + env(safe-area-inset-bottom));
            }
        }
        
        /* Custom Scrollbar for Sidebar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #E5E7EB;
            border-radius: 20px;
        }
        @media print {
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            body { background: white; }
            .card { box-shadow: none; border: 1px solid #eee; }
        }
    }

    @layer components {
        .btn {
            @apply px-6 py-3 rounded-2xl font-bold transition-all duration-200 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed select-none text-base shadow-sm active:scale-95;
        }
        .btn-primary {
            @apply bg-[var(--primary-color)] text-white hover:bg-[var(--primary-hover)] shadow-md hover:shadow-lg;
        }
        .btn-ghost {
            @apply hover:bg-gray-100 text-gray-700 active:bg-gray-200;
        }
        .card {
            @apply bg-white rounded-3xl shadow-md border border-gray-150 p-6 backdrop-blur-xl;
        }
        .card-elevated {
            @apply bg-white rounded-3xl shadow-lg border border-gray-100 p-6;
        }
        /* ==================== CONSISTENT INPUT FIELDS ==================== */
        .input-field {
            @apply w-full px-4 py-3 rounded-2xl border-2 border-gray-300 focus:border-emerald-500 focus:outline-none outline-none transition-all text-base font-medium bg-white;
            -webkit-appearance: none;
            -webkit-border-radius: 16px;
            box-shadow: none;
        }
        .input-field:focus {
            border-color: #10B981;
            box-shadow: 0 0 0 0px rgba(16, 185, 129, 0.1);
        }
        .input-field::placeholder {
            color: #9CA3AF;
        }

        /* Select Input Consistency */
        select.input-field {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath fill='%239CA3AF' d='M1 1l5 5 5-5'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            padding-right: 2.5rem;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
        }

        /* ==================== CONSISTENT BUTTONS ==================== */
        .btn {
            @apply px-6 py-3 rounded-xl font-bold transition-all duration-200 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed select-none text-base shadow-sm active:scale-95;
            border: none;
            cursor: pointer;
            -webkit-appearance: none;
        }
        .btn-primary {
            @apply bg-emerald-500 text-white hover:bg-emerald-600 active:bg-emerald-700 shadow-md;
        }
        .btn-primary:disabled {
            @apply bg-gray-300;
        }
        .btn-secondary {
            @apply bg-gray-200 text-gray-900 hover:bg-gray-300 active:bg-gray-400;
        }
        .btn-danger {
            @apply bg-red-500 text-white hover:bg-red-600 active:bg-red-700;
        }
        .btn-ghost {
            @apply hover:bg-gray-100 text-gray-700 active:bg-gray-200 shadow-none;
        }
        .btn-light {
            @apply bg-gray-100 text-gray-900 hover:bg-gray-200 active:bg-gray-300;
        }

        /* ==================== CONSISTENT CARDS ==================== */
        .card {
            @apply bg-white rounded-2xl shadow-sm border border-gray-200 p-6 backdrop-blur-xl transition-all;
        }
        .card:hover {
            @apply shadow-md;
        }
        .card-elevated {
            @apply bg-white rounded-2xl shadow-lg border border-gray-100 p-6;
        }
        .card-ghost {
            @apply bg-transparent border-none shadow-none p-6;
        }

        /* iOS Card Styling */
        .ios-card {
            @apply bg-white rounded-xl shadow-sm border border-gray-200 p-4 sm:p-6;
        }

        /* ==================== CONSISTENT MODALS/POPUPS ==================== */
        .modal {
            @apply fixed inset-0 bg-black/50 backdrop-blur-md z-50 flex items-end sm:items-center justify-center sm:p-4;
        }
        .modal-content {
            @apply bg-white rounded-2xl shadow-2xl max-w-sm w-full p-6 sm:rounded-3xl animate-scale-in;
        }
        .modal-header {
            @apply text-center mb-6;
        }
        .modal-title {
            @apply text-2xl font-bold text-gray-900;
        }
        .modal-body {
            @apply space-y-4 mb-6;
        }
        .modal-footer {
            @apply flex flex-col gap-3;
        }

        /* ==================== CONSISTENT SIDEBAR ==================== */
        .sidebar-item {
            @apply flex items-center gap-3 px-4 py-3 text-gray-600 rounded-xl hover:bg-emerald-50 transition-all cursor-pointer select-none font-medium text-base;
        }
        .sidebar-item.active {
            @apply bg-emerald-100 text-emerald-700 font-bold shadow-sm;
        }

        /* ==================== CONSISTENT BADGES ==================== */
        .badge {
            @apply px-3 py-1.5 rounded-full text-xs font-bold inline-flex items-center gap-1;
        }
        .badge-success {
            @apply bg-emerald-100 text-emerald-800;
        }
        .badge-warning {
            @apply bg-amber-100 text-amber-800;
        }
        .badge-error {
            @apply bg-red-100 text-red-800;
        }
        .badge-info {
            @apply bg-blue-100 text-blue-800;
        }

        /* ==================== CONSISTENT TABS ==================== */
        .tab-list {
            @apply flex gap-2 border-b border-gray-200 overflow-x-auto;
        }
        .tab-item {
            @apply px-4 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:text-gray-900 border-b-2 border-transparent transition-all;
        }
        .tab-item.active {
            @apply text-emerald-600 border-b-2 border-emerald-600 font-bold;
        }

        /* ==================== CONSISTENT FORMS ==================== */
        .form-group {
            @apply mb-4;
        }
        .form-label {
            @apply block text-sm font-semibold text-gray-700 mb-2;
        }
        .form-error {
            @apply text-red-500 text-sm mt-1;
        }
        .form-hint {
            @apply text-gray-500 text-xs mt-1;
        }

        /* ==================== CONSISTENT ALERT BOXES ==================== */
        .alert {
            @apply p-4 rounded-xl border mb-4;
        }
        .alert-success {
            @apply bg-emerald-50 border-emerald-200 text-emerald-900;
        }
        .alert-warning {
            @apply bg-amber-50 border-amber-200 text-amber-900;
        }
        .alert-error {
            @apply bg-red-50 border-red-200 text-red-900;
        }
        .alert-info {
            @apply bg-blue-50 border-blue-200 text-blue-900;
        }

        /* ==================== CONSISTENT SPINNER/LOADERS ==================== */
        .spinner {
            @apply w-6 h-6 border-3 border-gray-300 border-t-emerald-500 rounded-full animate-spin;
        }
        .spinner-small {
            @apply w-4 h-4 border-2 border-gray-300 border-t-emerald-500 rounded-full animate-spin;
        }
        /* iOS Animations */
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        .animate-fade-in-up {
            animation: fadeInUp 0.3s ease-out;
        }
        .animate-slide-down {
            animation: slideDown 0.3s ease-out;
        }
        .animate-bounce-light {
            animation: bounceLight 0.6s ease-out;
        }
        .animate-scale-in {
            animation: scaleIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideDown {
            from { transform: translateY(-100%); }
            to { transform: translateY(0); }
        }
        @keyframes bounceLight {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }
    }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <!-- App Scripts -->
    <script type="text/babel" src="utils/dataManager.js"></script>
    <script type="text/babel" src="utils/gestureHooks.js"></script>
    <script type="text/babel" src="utils/ValidationAndSecurity.js"></script>
    <script type="text/babel" src="components/UIComponents.js"></script>
    <script type="text/babel" src="components/GestureUI.js"></script>
    <script type="text/babel" src="components/Sidebar.js"></script>
    <script type="text/babel" src="components/Header.js"></script>
    <script type="text/babel" src="components/BottomNav.js"></script>
    <script type="text/babel" src="components/Dashboard.js"></script>
    <script type="text/babel" src="components/Transactions.js"></script>
    <script type="text/babel" src="components/CalendarView.js"></script>
    <script type="text/babel" src="components/Budget.js"></script>
    <script type="text/babel" src="components/Goals.js"></script>
    <script type="text/babel" src="components/Bills.js"></script>
    <script type="text/babel" src="components/Investments.js"></script>
    <script type="text/babel" src="components/Accounts.js"></script>
    <script type="text/babel" src="components/Loans.js"></script>
    <script type="text/babel" src="components/Tools.js"></script>
    <script type="text/babel" src="components/Settings.js"></script>
    <script type="text/babel" src="components/Reports.js"></script>
    <!-- নতুন উন্নত ফিচার -->
    <script type="text/babel" src="components/AdvancedFeatures.js"></script>
    <script type="text/babel" src="components/AdvancedAnalyticsPanel.js"></script>
    <script type="text/babel" src="components/AdvancedSearchFilter.js"></script>
    <script type="text/babel" src="components/AdvancedTools.js"></script>
    <script type="text/babel" src="components/PredictiveAnalytics.js"></script>
    <script type="text/babel" src="components/RecurringTransactionManager.js"></script>
    <script type="text/babel" src="components/MobilePaymentIntegration.js"></script>
    <script type="text/babel" src="components/SmartBudgetPlanning.js"></script>
    <script type="text/babel" src="components/SmartBillingSystem.js"></script>
    <script type="text/babel" src="components/NetWorthTracker.js"></script>
    <script type="text/babel" src="components/SystemSettings.js"></script>
    <script type="text/babel" src="app.js"></script>
</body>
</html>